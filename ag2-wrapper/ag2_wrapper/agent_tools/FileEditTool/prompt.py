"""
FileEditTool 的提示词配置
"""

PROMPT = """这是一个用于编辑文件的工具。对于移动或重命名文件，应该使用 Bash 工具的 'mv' 命令。对于大型编辑，使用 Write 工具覆盖文件。对于 Jupyter notebooks (.ipynb 文件)，请使用 NotebookEditTool。

使用此工具前：

1. 使用 FileReadTool 工具了解文件内容和上下文

2. 验证目录路径是否正确（仅适用于创建新文件时）：
   - 使用 LS 工具验证父目录存在且位置正确

要进行文件编辑，请提供以下内容：
1. file_path：要修改的文件的绝对路径（必须是绝对路径，不能是相对路径）
2. old_string：要替换的文本（必须在文件中唯一存在，且必须与文件内容完全匹配，包括所有空格和缩进）
3. new_string：用于替换 old_string 的编辑后的文本
4. context：包含read_timestamps字典的上下文参数（必需）

该工具将在指定文件中替换 old_string 的一个实例为 new_string。

要往文件末尾添加新内容：
1. 使用 FileReadTool 工具查看文件，确保获取到文件的最后几行
2. 将 old_string 设置为文件的最后一行（包括换行符）
3. 将 new_string 设置为 "最后一行 + 换行符 + 要添加的新内容"
4. 如果最后一行没有换行符，new_string 应该先添加一个换行符

例如，要在文件末尾添加新行：
- old_string = "最后一行内容\\n"
- new_string = "最后一行内容\\n新的内容\\n"

如果文件末尾没有换行符：
- old_string = "最后一行内容"
- new_string = "最后一行内容\\n新的内容\\n"

使用此工具的关键要求：

1. 唯一性：old_string 必须唯一标识要更改的特定实例。这意味着：
   - 在更改点之前包含至少 3-5 行上下文
   - 在更改点之后包含至少 3-5 行上下文
   - 完全按照文件中的显示包含所有空格、缩进和周围代码

2. 单一实例：此工具一次只能更改一个实例。如果需要更改多个实例：
   - 对每个实例分别调用此工具
   - 每次调用都必须使用足够的上下文唯一标识其特定实例

3. 验证：使用此工具前：
   - 检查目标文本在文件中存在多少个实例
   - 如果存在多个实例，收集足够的上下文以唯一标识每个实例
   - 为每个实例规划单独的工具调用

警告：如果不遵循这些要求：
   - 如果 old_string 匹配多个位置，工具将失败
   - 如果 old_string 不完全匹配（包括空格），工具将失败
   - 如果不包含足够的上下文，可能会更改错误的实例

进行编辑时：
   - 确保编辑结果是符合习惯的正确代码
   - 不要使代码处于破损状态
   - 始终使用绝对文件路径（以 / 开头）

使用此工具前请注意：

1. 必须先使用 FileReadTool 读取文件内容
2. 确保要替换的内容在文件中是唯一的
3. 包含足够的上下文（3-5行）以确保正确定位
4. 保持代码格式和缩进的一致性
5. 每次调用只能修改一个实例
6. 对于大型修改，建议使用其他方式（如 mv 到 archive 再创建新文件）
7. 【重要】调用此工具时必须提供context参数，包含read_timestamps字典
   - 系统会自动跟踪文件的读取和修改时间戳
   - 只有先被FileReadTool成功读取的文件才能被编辑
   - 这种设计确保了文件操作的安全性

调用示例：

正确的调用格式：
```json
{
    "file_path": "/absolute/path/to/file.py",
    "old_string": "原始文本内容（需在文件中唯一存在）",
    "new_string": "新的文本内容",
    "context": {
        "read_timestamps": {}
    }
}
```

错误的调用格式（会导致错误）：
```json
{
    "file_path": "/absolute/path/to/file.py",
    "old_string": "原始文本内容",
    "new_string": "新的文本内容"
}
```

注意：每次调用都必须提供context参数，这是确保文件操作安全性的关键机制。
如果是第一次编辑文件，需要先使用FileReadTool读取文件，然后使用其返回的read_timestamps；
如果之前已经读取过文件，应该使用之前的read_timestamps。

记住：当对同一文件进行多次文件编辑时，应该在单个消息中使用多次调用此工具，而不是在多个消息中每次调用一次。"""

DESCRIPTION = "编辑已存在文件的内容（需要先使用 FileReadTool 读取文件）" 